@model CeyPASS.Web.Models.Admin.AdminPanelViewModel
@using System.Linq
@{
    ViewData["Title"] = "Admin Panel";
    var adminReturn = Url.Action("Index", "Admin");
}
<div class="page-header mb-3">
    <div>
        <h1 class="page-title">Admin Panel</h1>
        <p class="page-subtitle">Sekmelerde t√ºm verilerin tam listesi; ekleme, d√ºzenleme ve silme i≈ülemleri ilgili sekmeden yapƒ±labilir.</p>
    </div>
</div>

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}
@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["Success"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

<ul class="nav nav-tabs mb-3" id="adminTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "firma" ? "active" : "")" id="tab-firma" data-bs-toggle="tab" data-bs-target="#panel-firma" type="button" role="tab">Firma (@Model.Firmalar.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "isyeri" ? "active" : "")" id="tab-isyeri" data-bs-toggle="tab" data-bs-target="#panel-isyeri" type="button" role="tab">ƒ∞≈üyeri (@Model.Isyeriler.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "cihaz" ? "active" : "")" id="tab-cihaz" data-bs-toggle="tab" data-bs-target="#panel-cihaz" type="button" role="tab">Cihaz (@Model.Cihazlar.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "departman" ? "active" : "")" id="tab-departman" data-bs-toggle="tab" data-bs-target="#panel-departman" type="button" role="tab">Departman (@Model.Departmanlar.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "pozisyon" ? "active" : "")" id="tab-pozisyon" data-bs-toggle="tab" data-bs-target="#panel-pozisyon" type="button" role="tab">Pozisyon (@Model.Pozisyonlar.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "resmitatil" ? "active" : "")" id="tab-resmitatil" data-bs-toggle="tab" data-bs-target="#panel-resmitatil" type="button" role="tab">Resmi Tatil (@Model.ResmiTatiller.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "calismastatu" ? "active" : "")" id="tab-calismastatu" data-bs-toggle="tab" data-bs-target="#panel-calismastatu" type="button" role="tab">√áalƒ±≈üma Stat√ºs√º (@Model.CalismaStatuleri.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "vardiya" ? "active" : "")" id="tab-vardiya" data-bs-toggle="tab" data-bs-target="#panel-vardiya" type="button" role="tab">Vardiya (@Model.CalismaSekilleri.Count)</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link @(Model.AktifTab == "guncellememail" ? "active" : "")" id="tab-guncellememail" data-bs-toggle="tab" data-bs-target="#panel-guncellememail" type="button" role="tab">G√ºncelleme Bildirimi</button>
    </li>
</ul>

<div class="tab-content" id="adminTabContent">
    <!-- Firma -->
    <div class="tab-pane fade @(Model.AktifTab == "firma" ? "show active" : "")" id="panel-firma" role="tabpanel">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Firma listesi</h5>
                <a class="btn btn-sm btn-success" href="@Url.Action("Create", "Firma", new { returnUrl = adminReturn + "?tab=firma" })">Yeni Firma</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>FirmaId</th><th>Firma Adƒ±</th><th>IT Mail</th><th>ƒ∞≈ülemler</th></tr></thead>
                        <tbody>
                            @foreach (var f in Model.Firmalar)
                            {
                                <tr>
                                    <td>@f.FirmaId</td>
                                    <td>@f.FirmaAdi</td>
                                    <td>@(string.IsNullOrWhiteSpace(f.ITBirimMail) ? "-" : f.ITBirimMail)</td>
                                    <td>
                                        <a class="btn btn-sm btn-warning" href="@Url.Action("Edit", "Firma", new { id = f.FirmaId, returnUrl = adminReturn + "?tab=firma" })">D√ºzenle</a>
                                        <form method="post" action="@Url.Action("Delete", "Firma", new { id = f.FirmaId })" class="d-inline">
                                            @Html.AntiForgeryToken()
                                            <input type="hidden" name="returnUrl" value="@(adminReturn + "?tab=firma")" />
                                            <button type="button" class="btn btn-sm btn-danger btn-sil-onay" data-msg="Firmayƒ± silmek istiyor musunuz?">Sil</button>
                                        </form>
                                    </td>
                                </tr>
                            }
                            @if (!Model.Firmalar.Any()) { <tr><td colspan="4" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ƒ∞≈üyeri -->
    <div class="tab-pane fade @(Model.AktifTab == "isyeri" ? "show active" : "")" id="panel-isyeri" role="tabpanel">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">ƒ∞≈üyeri listesi</h5>
                <a class="btn btn-sm btn-success" href="@Url.Action("Create", "Isyeri", new { returnUrl = adminReturn + "?tab=isyeri" })">Yeni ƒ∞≈üyeri</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>FirmaId</th><th>ƒ∞≈üyeriId</th><th>ƒ∞≈üyeri Adƒ±</th><th>ƒ∞≈ülemler</th></tr></thead>
                        <tbody>
                            @foreach (var x in Model.Isyeriler)
                            {
                                <tr>
                                    <td>@x.FirmaId</td>
                                    <td>@x.IsyeriId</td>
                                    <td>@x.Ad</td>
                                    <td>
                                        <a class="btn btn-sm btn-warning" href="@Url.Action("Edit", "Isyeri", new { firmaId = x.FirmaId, isyeriId = x.IsyeriId, returnUrl = adminReturn + "?tab=isyeri" })">D√ºzenle</a>
                                        <form method="post" action="@Url.Action("Delete", "Isyeri")" class="d-inline">
                                            @Html.AntiForgeryToken()
                                            <input type="hidden" name="firmaId" value="@x.FirmaId" />
                                            <input type="hidden" name="isyeriId" value="@x.IsyeriId" />
                                            <input type="hidden" name="returnUrl" value="@(adminReturn + "?tab=isyeri")" />
                                            <button type="button" class="btn btn-sm btn-danger btn-sil-onay" data-msg="ƒ∞≈üyerini silmek istiyor musunuz?">Sil</button>
                                        </form>
                                    </td>
                                </tr>
                            }
                            @if (!Model.Isyeriler.Any()) { <tr><td colspan="4" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Cihaz -->
    <div class="tab-pane fade @(Model.AktifTab == "cihaz" ? "show active" : "")" id="panel-cihaz" role="tabpanel">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Cihaz listesi</h5>
                <a class="btn btn-sm btn-success" href="@Url.Action("Create", "Cihaz", new { returnUrl = adminReturn + "?tab=cihaz" })">Yeni Cihaz</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>CihazId</th><th>Firma</th><th>Cihaz Adƒ±</th><th>IP:Port</th><th>Aktif</th><th>ƒ∞≈ülemler</th></tr></thead>
                        <tbody>
                            @foreach (var c in Model.Cihazlar)
                            {
                                <tr>
                                    <td>@c.CihazId</td>
                                    <td>@c.FirmaAdi</td>
                                    <td>@c.CihazAdi</td>
                                    <td>@c.IPAdres:@c.Port</td>
                                    <td>@(c.AktifMi ? "Evet" : "Hayƒ±r")</td>
                                    <td>
                                        <a class="btn btn-sm btn-warning" href="@Url.Action("Edit", "Cihaz", new { id = c.CihazId, returnUrl = adminReturn + "?tab=cihaz" })">D√ºzenle</a>
                                    </td>
                                </tr>
                            }
                            @if (!Model.Cihazlar.Any()) { <tr><td colspan="6" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Departman -->
    <div class="tab-pane fade @(Model.AktifTab == "departman" ? "show active" : "")" id="panel-departman" role="tabpanel">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Departman listesi</h5>
                <a class="btn btn-sm btn-success" href="@Url.Action("Create", "Departman", new { returnUrl = adminReturn + "?tab=departman" })">Yeni Departman</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>Id</th><th>Ad</th><th>A√ßƒ±klama</th><th>ƒ∞≈ülemler</th></tr></thead>
                        <tbody>
                            @foreach (var d in Model.Departmanlar)
                            {
                                <tr>
                                    <td>@d.Id</td>
                                    <td>@d.Ad</td>
                                    <td>@(d.Aciklama ?? "-")</td>
                                    <td>
                                        <a class="btn btn-sm btn-warning" href="@Url.Action("Edit", "Departman", new { id = d.Id, returnUrl = adminReturn + "?tab=departman" })">D√ºzenle</a>
                                        <form method="post" action="@Url.Action("Delete", "Departman", new { id = d.Id })" class="d-inline">
                                            @Html.AntiForgeryToken()
                                            <input type="hidden" name="returnUrl" value="@(adminReturn + "?tab=departman")" />
                                            <button type="button" class="btn btn-sm btn-danger btn-sil-onay" data-msg="Departmanƒ± silmek istiyor musunuz?">Sil</button>
                                        </form>
                                    </td>
                                </tr>
                            }
                            @if (!Model.Departmanlar.Any()) { <tr><td colspan="4" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Pozisyon -->
    <div class="tab-pane fade @(Model.AktifTab == "pozisyon" ? "show active" : "")" id="panel-pozisyon" role="tabpanel">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Pozisyon listesi</h5>
                <a class="btn btn-sm btn-success" href="@Url.Action("Create", "Pozisyon", new { returnUrl = adminReturn + "?tab=pozisyon" })">Yeni Pozisyon</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>Id</th><th>Ad</th><th>A√ßƒ±klama</th><th>ƒ∞≈ülemler</th></tr></thead>
                        <tbody>
                            @foreach (var p in Model.Pozisyonlar)
                            {
                                <tr>
                                    <td>@p.Id</td>
                                    <td>@p.Ad</td>
                                    <td>@(p.Aciklama ?? "-")</td>
                                    <td>
                                        <a class="btn btn-sm btn-warning" href="@Url.Action("Edit", "Pozisyon", new { id = p.Id, returnUrl = adminReturn + "?tab=pozisyon" })">D√ºzenle</a>
                                        <form method="post" action="@Url.Action("Delete", "Pozisyon", new { id = p.Id })" class="d-inline">
                                            @Html.AntiForgeryToken()
                                            <input type="hidden" name="returnUrl" value="@(adminReturn + "?tab=pozisyon")" />
                                            <button type="button" class="btn btn-sm btn-danger btn-sil-onay" data-msg="Pozisyonu silmek istiyor musunuz?">Sil</button>
                                        </form>
                                    </td>
                                </tr>
                            }
                            @if (!Model.Pozisyonlar.Any()) { <tr><td colspan="4" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Resmi Tatil -->
    <div class="tab-pane fade @(Model.AktifTab == "resmitatil" ? "show active" : "")" id="panel-resmitatil" role="tabpanel">
        <div class="card">
            <div class="card-header"><h5 class="mb-0">Resmi tatil listesi</h5></div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>Tarih</th><th>Ad</th><th>√áalƒ±≈üma Saati</th></tr></thead>
                        <tbody>
                            @foreach (var r in Model.ResmiTatiller)
                            {
                                <tr>
                                    <td>@r.Tarih.ToString("dd.MM.yyyy")</td>
                                    <td>@r.Ad</td>
                                    <td>@(r.CalismaSaati?.ToString("0.##") ?? "-")</td>
                                </tr>
                            }
                            @if (!Model.ResmiTatiller.Any()) { <tr><td colspan="3" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer small text-muted">Ekleme/d√ºzenleme i√ßin <a href="@Url.Action("Index", "ResmiTatil")">Resmi Tatiller sayfasƒ±na</a> gidin.</div>
        </div>
    </div>

    <!-- √áalƒ±≈üma Stat√ºs√º -->
    <div class="tab-pane fade @(Model.AktifTab == "calismastatu" ? "show active" : "")" id="panel-calismastatu" role="tabpanel">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">√áalƒ±≈üma stat√ºs√º listesi</h5>
                <a class="btn btn-sm btn-success" href="@Url.Action("Index", "CalismaStatu")">Yeni eklemek i√ßin sayfaya git</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>Id</th><th>Ad</th><th>ƒ∞≈ülemler</th></tr></thead>
                        <tbody>
                            @foreach (var s in Model.CalismaStatuleri)
                            {
                                <tr>
                                    <td>@s.Id</td>
                                    <td>@s.Ad</td>
                                    <td>
                                        <a class="btn btn-sm btn-warning" href="@Url.Action("Index", "CalismaStatu")#edit-@s.Id">D√ºzenle</a>
                                        <form method="post" action="@Url.Action("Delete", "CalismaStatu", new { id = s.Id })" class="d-inline">
                                            @Html.AntiForgeryToken()
                                            <input type="hidden" name="returnUrl" value="@(adminReturn + "?tab=calismastatu")" />
                                            <button type="button" class="btn btn-sm btn-danger btn-sil-onay" data-msg="Bu √ßalƒ±≈üma stat√ºs√ºn√º silmek istiyor musunuz?">Sil</button>
                                        </form>
                                    </td>
                                </tr>
                            }
                            @if (!Model.CalismaStatuleri.Any()) { <tr><td colspan="3" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Vardiya (√áalƒ±≈üma ≈ûekli) -->
    <div class="tab-pane fade @(Model.AktifTab == "vardiya" ? "show active" : "")" id="panel-vardiya" role="tabpanel">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Vardiya listesi</h5>
                <a class="btn btn-sm btn-success" href="@Url.Action("Index", "CalismaSekli")">Yeni eklemek i√ßin sayfaya git</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead><tr><th>Id</th><th>FirmaId</th><th>Ad</th><th>Ba≈ülangƒ±√ß</th><th>Biti≈ü</th></tr></thead>
                        <tbody>
                            @foreach (var v in Model.CalismaSekilleri)
                            {
                                <tr>
                                    <td>@v.Id</td>
                                    <td>@v.FirmaId</td>
                                    <td>@v.Ad</td>
                                    <td>@v.Baslangic.ToString(@"hh\:mm")</td>
                                    <td>@v.Bitis.ToString(@"hh\:mm")</td>
                                </tr>
                            }
                            @if (!Model.CalismaSekilleri.Any()) { <tr><td colspan="5" class="text-muted">Kayƒ±t yok.</td></tr> }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer small text-muted">Ekleme/d√ºzenleme i√ßin <a href="@Url.Action("Index", "CalismaSekli")">Vardiyalar sayfasƒ±na</a> gidin.</div>
        </div>
    </div>

    <!-- G√ºncelleme Bildirimi (Mail) -->
    <div class="tab-pane fade @(Model.AktifTab == "guncellememail" ? "show active" : "")" id="panel-guncellememail" role="tabpanel">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-envelope-check me-2"></i>G√ºncelleme Bildirimi</h5>
                <p class="mb-0 small text-muted mt-1">Yeni bir g√ºncelleme yapƒ±ldƒ±ƒüƒ±nda duyuru mailini buradan olu≈üturup g√∂nderebilirsiniz.</p>
            </div>
            <div class="card-body">
                <form id="guncellemeMailForm" method="post" asp-action="GuncellemeMailGonder" asp-controller="Admin">
                    @Html.AntiForgeryToken()
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label class="form-label">Versiyon No <span class="text-danger">*</span></label>
                            <input type="text" name="VersiyonNumarasi" class="form-control" value="1.0.0" required />
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Yayƒ±n Tarihi <span class="text-danger">*</span></label>
                            <input type="date" name="YayinTarihi" class="form-control" value="@DateTime.Today.ToString("yyyy-MM-dd")" required />
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">G√ºncelleme Tipi <span class="text-danger">*</span></label>
                            <select name="GuncellemeTipi" class="form-select" required>
                                <option value="Major">Major</option>
                                <option value="Minor" selected>Minor</option>
                                <option value="Bugfix">Bugfix</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-12">
                            <label class="form-label">‚ú® Yeni √ñzellikler <small class="text-muted">(her satƒ±r bir madde)</small></label>
                            <textarea name="YeniOzelliklerMetni" class="form-control font-monospace" rows="3" placeholder="√ñzellik 1&#10;√ñzellik 2"></textarea>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-12">
                            <label class="form-label">‚ö° ƒ∞yile≈ütirmeler <small class="text-muted">(her satƒ±r bir madde)</small></label>
                            <textarea name="IyilestirmelerMetni" class="form-control font-monospace" rows="3" placeholder="ƒ∞yile≈ütirme 1&#10;ƒ∞yile≈ütirme 2"></textarea>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-12">
                            <label class="form-label">üîß Hata D√ºzeltmeleri <small class="text-muted">(her satƒ±r bir madde)</small></label>
                            <textarea name="HataDuzeltmeleriMetni" class="form-control font-monospace" rows="3" placeholder="D√ºzeltme 1&#10;D√ºzeltme 2"></textarea>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-12">
                            <label class="form-label">‚ö†Ô∏è Kritik Deƒüi≈üiklikler <small class="text-muted">(her satƒ±r bir madde)</small></label>
                            <textarea name="KritikDegisikliklerMetni" class="form-control font-monospace" rows="3" placeholder="Kritik deƒüi≈üiklik 1"></textarea>
                        </div>
                    </div>
                    <div class="row mb-4">
                        <div class="col-12">
                            <label class="form-label">üìù Ek Notlar</label>
                            <textarea name="EkNotlar" class="form-control" rows="2">Bu g√ºncelleme yapƒ±ldƒ±ktan sonra uygulamanƒ±n yeniden ba≈ülatƒ±lmasƒ± gerekmektedir.</textarea>
                        </div>
                    </div>
                    <div class="d-flex gap-2 justify-content-end">
                        <button type="submit" formaction="@Url.Action("GuncellemeMailOnizleme", "Admin")" formtarget="_blank" class="btn btn-outline-secondary" name="action" value="onizleme">
                            <i class="bi bi-eye me-1"></i>√ñnizleme
                        </button>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#guncellemeMailOnayModal">
                            <i class="bi bi-send me-1"></i>G√∂nder
                        </button>
                    </div>
                </form>

                <!-- G√ºncelleme maili g√∂nder onay modal (formun dƒ±≈üƒ±nda; G√∂nder tƒ±klanƒ±nca #guncellemeMailForm submit edilir) -->
                <div class="modal fade" id="guncellemeMailOnayModal" tabindex="-1" aria-labelledby="guncellemeMailOnayModalLabel" aria-hidden="true" data-bs-backdrop="static">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="guncellemeMailOnayModalLabel"><i class="bi bi-envelope-check me-2"></i>G√ºncelleme Bildirimi G√∂nder</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
                            </div>
                            <div class="modal-body">
                                G√ºncelleme bildirimi t√ºm ilgili kullanƒ±cƒ±lara g√∂nderilecek. Emin misiniz?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                                <button type="button" class="btn btn-primary" id="guncellemeMailOnayGonderBtn">
                                    <i class="bi bi-send me-1"></i>G√∂nder
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Silme onay modal (Firma, ƒ∞≈üyeri, Departman, Pozisyon, √áalƒ±≈üma Stat√ºs√º) -->
<div class="modal fade" id="silOnayModal" tabindex="-1" aria-labelledby="silOnayModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="silOnayModalLabel"><i class="bi bi-exclamation-triangle me-2"></i>Silme Onayƒ±</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
            </div>
            <div class="modal-body" id="silOnayModalBody"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                <button type="button" class="btn btn-danger" id="silOnayModalSilBtn"><i class="bi bi-trash me-1"></i>Sil</button>
            </div>
        </div>
    </div>
</div>

<script>
    (function () {
        var hash = window.location.hash || '#tab-' + '@Model.AktifTab';
        if (hash.indexOf('tab-') === 1) {
            var tabId = hash.replace('#tab-', '');
            var btn = document.getElementById('tab-' + tabId);
            if (btn) { var b = new bootstrap.Tab(btn); b.show(); }
        }

        // G√ºncelleme maili g√∂nder onay modal: G√∂nder'e basƒ±nca formu g√∂nder
        var onayModal = document.getElementById('guncellemeMailOnayModal');
        var gonderBtn = document.getElementById('guncellemeMailOnayGonderBtn');
        var guncellemeMailForm = document.getElementById('guncellemeMailForm');
        if (onayModal && gonderBtn && guncellemeMailForm) {
            gonderBtn.addEventListener('click', function (e) {
                e.preventDefault();
                var modalInstance = bootstrap.Modal.getInstance(onayModal);
                if (modalInstance) modalInstance.hide();
                // Formu kƒ±sa gecikmeyle g√∂nder (modal kapanƒ±rken submit kaybolmasƒ±n)
                setTimeout(function () { guncellemeMailForm.submit(); }, 100);
            });
        }

        // Silme onay modal: .btn-sil-onay tƒ±klanƒ±nca modal a√ß, onayda formu g√∂nder
        var silOnayModalEl = document.getElementById('silOnayModal');
        var silOnayModalBody = document.getElementById('silOnayModalBody');
        var silOnayModalSilBtn = document.getElementById('silOnayModalSilBtn');
        if (silOnayModalEl && silOnayModalBody && silOnayModalSilBtn) {
            document.querySelectorAll('.btn-sil-onay').forEach(function (btn) {
                btn.addEventListener('click', function () {
                    var form = this.closest('form');
                    var msg = this.getAttribute('data-msg') || 'Silmek istiyor musunuz?';
                    silOnayModalBody.textContent = msg;
                    var modal = new bootstrap.Modal(silOnayModalEl);
                    silOnayModalSilBtn.onclick = function () {
                        modal.hide();
                        if (form) form.submit();
                    };
                    modal.show();
                });
            });
        }
    })();
</script>
